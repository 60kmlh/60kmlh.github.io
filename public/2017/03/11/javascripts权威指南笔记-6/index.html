<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>《javascript权威指南》第六章读书笔记 · 60km/h</title><meta name="description" content="《javascript权威指南》第六章读书笔记 - 60kmlh"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/gandalfr.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/monokai.min.css"><link rel="search" type="application/opensearchdescription+xml" href="http://60kmlh.github.io/atom.xml" title="60km/h"></head><body><div class="wrap"><header><div class="title_wrap"><p>60km/h</p><span class="subtitle typing">好记性不如烂笔头</span></div><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">文章</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">关于</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">《javascript权威指南》第六章读书笔记</h1><div class="tags"><a href="/tags/object/" class="tag-title">#object</a></div><div class="post-info">2017年3月11日</div><div class="post-content"><h2 id="6-1-创建对象"><a href="#6-1-创建对象" class="headerlink" title="6.1 创建对象"></a>6.1 创建对象</h2><h3 id="创建对象三种的方式"><a href="#创建对象三种的方式" class="headerlink" title="创建对象三种的方式"></a>创建对象三种的方式</h3><ol>
<li>使用对象直接量</li>
</ol>
<p>创建对象最简单的方式就是在JavaScript代码中使用对象直接量(key / value)。</p>
<p>在ECMAScript 5中，对象直接量中的最后一个属性后的逗号将忽略，且在ECMAScript 3的大部分实行中也可以忽略这个逗号，但在IE中则报错。<br><a id="more"></a><br>所有通过对象直接量创建的对象具有同一个原型对象，即Object.prototype。Object.prototype没有原型。</p>
<ol start="2">
<li>使用new运算符</li>
</ol>
<p>关键字new后跟随一个构造函数使用，创建的对象的原型是构造函数的prototype属性的值。</p>
<p>所有通过对象直接量创建的对象具有同一个原型对象，即Object.prototype。Object.prototype没有原型。</p>
<ol start="3">
<li>使用Object.create() </li>
</ol>
<p>ECMAScript 5中使用Object.create(obj)传入原型对象，创建的对象会继承该原型的属性。传入Null则创建一个没有原型的对象,不继承任何属性。</p>
<p>在ECMASCript 3中模拟原型继承<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="built_in">TypeError</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.create) <span class="keyword">return</span> <span class="built_in">Object</span>.create(p);</span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">typeof</span> p;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="string">'function'</span> &amp;&amp; t != <span class="string">'object'</span>) <span class="keyword">throw</span> <span class="built_in">TypeError</span>();</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; &#125;;</span><br><span class="line">    f.prototype = p;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> f()</span><br></pre></td></tr></table></figure></p>
<h2 id="6-2-属性的查询和设置"><a href="#6-2-属性的查询和设置" class="headerlink" title="6.2 属性的查询和设置"></a>6.2 属性的查询和设置</h2><p>可以通过点(.)或者方括号([])运算符获取属性的值。</p>
<p>Javascript对象具有’自有属性’，也有原型属性是从原型对象继承而来的。</p>
<p>查询对象o的属性x，如果在o中找不到x，则在o的原型对象中查找属性x。如果该原型对象也没有属性x，但这个原型对象也有原型，那么继续在这个原型对象的原型上执行查询，直到找到x属性或者一个原型是null的对象为止。即对象的原型属性构成一个’链’。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;&#125;</span><br><span class="line">o.x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> p = inherit(o)</span><br><span class="line">p.y = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> q = inherit(p)</span><br><span class="line">q.z = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">var</span> s = q.toString()</span><br><span class="line"><span class="built_in">console</span>.log(s)<span class="comment">//[object Object]</span></span><br><span class="line"><span class="built_in">console</span>.log(q.x+q.y)<span class="comment">//3</span></span><br></pre></td></tr></table></figure></p>
<p>如果允许属性赋值操作，那么它总是在原始对象上进行属性创建或者对已有属性进行赋值，而不会去修改原型链。</p>
<p>查询属性才和继承有关，设置属性则无关，改特性可以选择性得覆盖继承的属性。</p>
<p>查询一个不存在的属性不会报错，返回undefined。如果对象不存在，查找这个不存在的对象的属性就会报错。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> len = book&amp;&amp;book.substitle&amp;&amp;book.substitle.length;</span><br></pre></td></tr></table></figure></p>
<h2 id="6-3删除属性"><a href="#6-3删除属性" class="headerlink" title="6.3删除属性"></a>6.3删除属性</h2><p>使用delete刪除屬性。delete只是断开属性与宿主之间的联系，而不会去操作属性中的属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;<span class="attr">p</span>:&#123;<span class="attr">x</span>:<span class="number">1</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.p;</span><br><span class="line"><span class="keyword">delete</span> a.p;</span><br><span class="line"><span class="built_in">console</span>.log(a.p);<span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(b);<span class="comment">//&#123;x:1&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>delete不行删除可configurable为false的属性。</p>
<h2 id="6-4检测属性"><a href="#6-4检测属性" class="headerlink" title="6.4检测属性"></a>6.4检测属性</h2><p>检测某个属性是否存在于某个对象中。</p>
<ol>
<li>in运算符</li>
</ol>
<p>如果对象的自有属性或继承属性包含这个属性，则返回true。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;<span class="attr">x</span>:<span class="number">1</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'x'</span> <span class="keyword">in</span> a);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString'</span> <span class="keyword">in</span> a);<span class="comment">//true</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>hasOwnProperty()</li>
</ol>
<p>该方法用来检测给定的名字是否是对象的自有属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;<span class="attr">x</span>:<span class="number">1</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(a.hasOwnProperty(<span class="string">'x'</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(a.hasOwnProperty(<span class="string">'toString'</span>));<span class="comment">//false</span></span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>propertyIsEnumerable()</li>
</ol>
<p>检测到是自有属性且这个属性的enumerable特性为true是，返回true。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = inherit(&#123;<span class="attr">x</span>:<span class="number">1</span>&#125;);</span><br><span class="line">o.y = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(o.propertyIsEnumerable(<span class="string">'x'</span>))<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(o.propertyIsEnumerable(<span class="string">'y'</span>))<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(o.propertyIsEnumerable(<span class="string">'toString'</span>))<span class="comment">//false</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-5枚举属性"><a href="#6-5枚举属性" class="headerlink" title="6.5枚举属性"></a>6.5枚举属性</h2><p>使用for/in便利对象所有可枚举的属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">x</span>:<span class="number">1</span> ,<span class="attr">y</span>:<span class="number">2</span>, <span class="attr">z</span>:<span class="number">3</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(o.propertyIsEnumerable(<span class="string">'toString'</span>))<span class="comment">//fasle</span></span><br><span class="line"><span class="keyword">for</span>(prop <span class="keyword">in</span> o)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(prop)</span><br><span class="line">&#125;<span class="comment">//x y z</span></span><br></pre></td></tr></table></figure></p>
<p>ECMAScript 5中使用Object.keys(obj)返回一个数组，数组由对象中的可枚举的自有属性组成。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">x</span>:<span class="number">1</span>,<span class="attr">y</span>:<span class="number">2</span>&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o,<span class="string">'y'</span>,&#123;<span class="attr">enumerable</span>:<span class="literal">false</span>&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(o));<span class="comment">//['x']</span></span><br></pre></td></tr></table></figure></p>
<p>ECMAScript 5中使用Object.getOwnPropertyNames(obj)返回对象所有的自有属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">x</span>:<span class="number">1</span>,<span class="attr">y</span>:<span class="number">2</span>&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o,<span class="string">'y'</span>,&#123;<span class="attr">enumerable</span>:<span class="literal">false</span>&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(o));<span class="comment">//['x','y']</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-6属性的getter和setter"><a href="#6-6属性的getter和setter" class="headerlink" title="6.6属性的getter和setter"></a>6.6属性的getter和setter</h2><p>在ECMAScript 5中 ，对象的属性可以有一个或两个函数代替，即getter和getter。由getter和setter定义的属性叫做’存取器属性’(accessor property)，不同于’数据属性’(data property)。</p>
<p>存取器属性定义为一个或两个和属性同名的函数，不使用function关键字，而是使用get和set。</p>
<p>存取器属性不具有可写性(writable attribute)。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> serialNum=&#123;</span><br><span class="line">    $n:<span class="number">0</span>,</span><br><span class="line">    <span class="keyword">get</span> next()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.$n++</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span> next(n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&gt;<span class="keyword">this</span>.$n) <span class="keyword">this</span>.$n=n*<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">throw</span> <span class="string">'序列号的值不能比当前值小'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(serialNum.next)<span class="comment">//0</span></span><br><span class="line"><span class="built_in">console</span>.log(serialNum.next)<span class="comment">//1</span></span><br><span class="line">serialNum.next=<span class="number">10</span>;</span><br><span class="line"><span class="built_in">console</span>.log(serialNum.next)<span class="comment">//30</span></span><br><span class="line"><span class="built_in">console</span>.log(serialNum.next)<span class="comment">//31</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-7属性的特性"><a href="#6-7属性的特性" class="headerlink" title="6.7属性的特性"></a>6.7属性的特性</h2><p>数据属性的4个特性是：value writable enumerable configurable。</p>
<p>存取器属性不具有value和writable特性，其可写性有setter方法是否存在决定。</p>
<p>存取器属性的4个特性是：get set enumerable configurable。</p>
<p>通过调用Object.getOwnPropertyDescriptor(obj,propName)获得某个对象特定属性的属性描述符。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(&#123;<span class="attr">x</span>:<span class="number">1</span>&#125;,<span class="string">'x'</span>))<span class="comment">//&#123; value: 1, writable: true, enumerable: true, configurable: true &#125;</span></span><br></pre></td></tr></table></figure></p>
<p>设置属性的特性则是使用Object.defineProperty(obj,propName,desc)和Object.defineProperties(obj,desc)</p>
<p>赋值属性的特性<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Object</span>.prototype,<span class="string">'extend'</span>,&#123;</span><br><span class="line">    writable:<span class="literal">true</span>,</span><br><span class="line">    enumerable:<span class="literal">false</span>,</span><br><span class="line">    configurable:<span class="literal">true</span>,</span><br><span class="line">    value:<span class="function"><span class="keyword">function</span>(<span class="params">o</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> names=<span class="built_in">Object</span>.getOwnPropertyNames(o);</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">let</span> i=<span class="number">0</span>;i&lt;names.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(names[i] <span class="keyword">in</span> <span class="keyword">this</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">var</span> desc = <span class="built_in">Object</span>.getOwnPropertyDescriptor(o,names[i]);</span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>,names[i],desc)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="6-8对象的3个属性"><a href="#6-8对象的3个属性" class="headerlink" title="6.8对象的3个属性"></a>6.8对象的3个属性</h2><ol>
<li>原型(prototype)</li>
</ol>
<p>ECMAScript 5中使用Object.getProprttyOf(obj)查询对象的原型。</p>
<p>ECMAScript 3中使用o.constructor.prototype检查对象的原型(不可靠)。</p>
<p>使用isPrototypeOf检测一个对象是否是另一个对象的原型。</p>
<ol start="2">
<li>类属性(class attribute)</li>
</ol>
<p>查询方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">classOf</span>(<span class="params">o</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(o===<span class="literal">null</span>) <span class="keyword">return</span> <span class="string">'Null'</span>;</span><br><span class="line">    <span class="keyword">if</span>(o===<span class="literal">undefined</span>) <span class="keyword">return</span> <span class="string">'Undefined'</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(o).slice(<span class="number">8</span>,<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>可扩展性(extensible attribute)</li>
</ol>
<p>对象的可扩展性表示是否可以给对象添加新属性。</p>
<p>所以内置对象和自定义对象都是显式可扩展的。</p>
<p>可以通过Object.esExtensible(obj)来检测对象是否是可扩展的</p>
<p>通过Object.preventExtensions(obj)、Object.seal(obj)、Object.freeze(obj)来将对象设置为不可扩展的</p>
<h2 id="6-9序列化对象"><a href="#6-9序列化对象" class="headerlink" title="6.9序列化对象"></a>6.9序列化对象</h2><p>对象序列化(serialization)是指对象的状态和字符串的互相转换。</p>
<p>ECMAScript 5内置函数JSON.stringify()和JSON.parse()来序列化和还原对象。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">x</span>:<span class="number">1</span>,<span class="attr">y</span>:&#123;<span class="attr">a</span>:<span class="number">1</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">var</span> s = <span class="built_in">JSON</span>.stringify(o);</span><br><span class="line"><span class="built_in">console</span>.log(s);<span class="comment">//&#123;"x":1,"y":&#123;"a":1&#125;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(s));<span class="comment">//Object &#123;x: 1, y: Object&#125;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-10对象方法"><a href="#6-10对象方法" class="headerlink" title="6.10对象方法"></a>6.10对象方法</h2><p>Object.prototype里常见的方法，例如toString(),valueOf()等，但有些特定的类会重写这些方法。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/03/18/javascripts权威指南笔记-8/" class="prev">上一篇</a><a href="/2017/03/04/promise/" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2022 <a href="http://60kmlh.github.io">60kmlh</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/MikeCoder/hexo-theme-gandalfr" target="_blank">hexo-theme-gandalfr</a>.</p></div></footer></div><script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js" crossorigin="anonymous"></script><script src="//cdn.bootcss.com/jquery/3.1.1/jquery.js" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-147983033-1",'auto');ga('send','pageview');</script><script>$(document).ready(function() { hljs.configure({useBR: true}); $('pre').each(function(i, block) { hljs.highlightBlock(block); }); });</script></body></html>